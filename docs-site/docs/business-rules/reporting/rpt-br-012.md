---
id: "rpt-br-012"
title: "Report access control and distribution"
domain: "reporting"
cobol_source: "CBTRN03C.cbl:1-650 (report output destination), COCOM01Y.cpy:19-31 (user security context)"
requirement_id: "RPT-BR-012"
regulations:
  - "FSA FFFS 2014:5 Ch. 7"
  - "FSA FFFS 2014:5 Ch. 8"
  - "GDPR Art. 5(1)(f)"
  - "GDPR Art. 25"
  - "GDPR Art. 32"
  - "DORA Art. 11"
status: "extracted"
validated_by: null
validated_date: null
priority: "high"
---

# RPT-BR-012: Report access control and distribution

## Summary

Reports generated by NordKredit AB contain sensitive financial data, customer PII, and regulatory information that must be distributed only to authorized personnel through secure channels. The mainframe system controls report access through JES output classes, RACF (Resource Access Control Facility) profiles, and operator-managed print queues — each report output dataset is assigned a security class that determines which TSO users can view or print it. The migrated system must implement equivalent access controls using Azure AD role-based access control (RBAC) with report-level permissions, secure distribution channels (encrypted email, authenticated portal), and GDPR-compliant handling of customer data within reports. Extracted from the mainframe security model (COCOM01Y.cpy user context), CBTRN03C report output handling, and regulatory access control requirements.

## Business Logic

### Pseudocode

```
REPORT ACCESS CONTROL FRAMEWORK:

    REPORT CLASSIFICATION:
        Each report type has a sensitivity classification:

        RESTRICTED (highest):
            AML screening reports (RPT-BR-002) — SAR candidates
            DORA incident reports (RPT-BR-006) — operational vulnerabilities
            FSA regulatory filings (RPT-BR-001) — pre-submission drafts
            Access: Compliance team only + MLRO (Money Laundering Reporting Officer)

        CONFIDENTIAL:
            Customer statements (RPT-BR-003) — contains PII
            Delinquency aging reports (RPT-BR-005) — customer financial status
            Access: Authorized business users + compliance

        INTERNAL:
            Daily transaction reports (RPT-BR-004) — operational data
            Management reports (RPT-BR-005) — business metrics
            Portfolio balance reports (RPT-BR-005) — aggregated data
            Access: Operations team + management + compliance

        PUBLIC (none currently):
            No NordKredit reports are classified as public

    ACCESS CONTROL RULES:

        Role-based access (mapped from mainframe RACF):
            COMPLIANCE_OFFICER:
                Can access: All report types
                Can distribute: Restricted, Confidential, Internal
                Can submit: Regulatory reports to FSA/Finanspolisen

            MLRO (Money Laundering Reporting Officer):
                Can access: AML reports, SAR filings
                Can distribute: AML reports to Finanspolisen
                Cannot access: Non-AML management reports

            OPERATIONS_MANAGER:
                Can access: Internal reports, daily transaction reports
                Cannot access: AML screening details, SAR candidates
                Can distribute: Internal reports to management

            RISK_MANAGER:
                Can access: Portfolio, delinquency, management reports
                Cannot access: AML screening details, SAR candidates
                Can distribute: Risk reports to board

            EXECUTIVE:
                Can access: Management summaries, portfolio reports
                Cannot access: Individual transaction details, AML details
                Can distribute: Board reports

            CUSTOMER_SERVICE:
                Can access: Customer statements (for the queried customer only)
                Cannot access: Aggregated reports, AML reports
                Cannot distribute: Bulk statement access

        Customer self-service access:
            Customers can access their own statements via online banking
            Access authenticated via Azure AD B2C
            Only their own account statements (never other customers)
            PII masking rules per RPT-BR-003 apply

    DISTRIBUTION CHANNELS:

        CHANNEL 1 — SECURE PORTAL (primary):
            Report published to authenticated portal
            User logs in via Azure AD (internal) or Azure AD B2C (customer)
            Role checked against report classification
            Download logged in audit trail

        CHANNEL 2 — ENCRYPTED EMAIL:
            For scheduled distribution to management
            Reports attached as password-protected PDF
            Encryption key distributed via separate channel
            Delivery confirmation tracked

        CHANNEL 3 — PRINT QUEUE (legacy compatibility):
            For physical statement mailing
            Printed in secure print facility
            Chain-of-custody logging
            GDPR: minimize printed PII

        CHANNEL 4 — API (Open Banking / PSD2 AISP):
            Statement data via API for authorized AISPs
            OAuth 2.0 authentication (PSD2 SCA)
            Data minimization: only transaction list and balances
            Rate-limited and logged

    MAINFRAME ACCESS MODEL:

        Current mainframe RACF profiles:
            REPORT.DALYREPT.** — Operations team, Compliance
            REPORT.AMLREPT.**  — Compliance, MLRO only
            REPORT.STMTREPT.** — Customer Service, Compliance
            REPORT.MGMTRPT.** — Management, Compliance
            REPORT.FSAREPT.**  — Compliance only (pre-submission)

        JES output class routing:
            Class A: Operations reports (print queue OPRPT)
            Class C: Compliance reports (held queue, release by MLRO)
            Class S: Statements (print queue STMTS, secure printer)
            Class M: Management reports (held queue, release by manager)

        Migration mapping:
            RACF profile → Azure AD RBAC role assignment
            JES output class → Azure Blob container + access policy
            Held queue → Approval workflow in Azure Logic Apps
```

### Access Control Matrix

| Report Type | Compliance | MLRO | Operations | Risk Mgr | Executive | Customer Service | Customer |
|---|---|---|---|---|---|---|---|
| AML screening (RPT-BR-002) | Read/Distribute | Read/Distribute | No access | No access | No access | No access | No access |
| DORA incidents (RPT-BR-006) | Read/Distribute | No access | Read only | Read only | Summary only | No access | No access |
| FSA regulatory (RPT-BR-001) | Read/Distribute/Submit | No access | No access | Read only | Summary only | No access | No access |
| Customer statements (RPT-BR-003) | Read | No access | No access | No access | No access | Read (per-customer) | Read (own only) |
| Daily transaction (RPT-BR-004) | Read | No access | Read | No access | No access | No access | No access |
| Management reports (RPT-BR-005) | Read | No access | Read | Read | Read | No access | No access |
| Delinquency aging (RPT-BR-005) | Read | No access | No access | Read | Summary only | No access | No access |

### Decision Table — Access Request Handling

| Requester Role | Report Classification | Access Granted | Condition |
|---|---|---|---|
| Compliance Officer | Any | Yes | Always |
| MLRO | Restricted (AML only) | Yes | AML reports only |
| MLRO | Restricted (non-AML) | No | DORA/FSA not in scope |
| Operations Manager | Internal | Yes | Always |
| Operations Manager | Confidential | No | Requires compliance approval |
| Risk Manager | Confidential (delinquency) | Yes | Aggregated data only |
| Risk Manager | Restricted | No | Not authorized |
| Executive | Internal (summary) | Yes | Summary/aggregated only |
| Customer | Confidential (own statement) | Yes | Authenticated + own account |
| Customer | Any other | No | Never |

## Source COBOL Reference

**Programs:** `CBTRN03C.cbl` (650 lines — report output), `COCOM01Y.cpy` (CICS COMMAREA — user security context)

The mainframe user security context (COCOM01Y.cpy) carries the user type that determines access:

```cobol
*    COCOM01Y — CICS COMMAREA layout
*    Lines 19-31: User identification and security fields
       05 CDEMO-USER-ID           PIC X(08).
       05 CDEMO-USER-TYPE         PIC X(01).
*         'A' = Admin, 'U' = Regular user
       05 CDEMO-USER-FNAME        PIC X(20).
       05 CDEMO-USER-LNAME        PIC X(20).
```

The `CDEMO-USER-TYPE` field ('A' for admin, 'U' for regular user) is the mainframe's basic RBAC. The migrated system maps this to a richer role model:

| Mainframe User Type | Migrated Role(s) |
|---|---|
| 'A' (Admin) | Compliance Officer, MLRO, Operations Manager (based on department) |
| 'U' (Regular) | Customer Service, Customer (based on context) |

CBTRN03C report output destination:
```cobol
000051           SELECT REPORT-FILE ASSIGN TO TRANREPT
000052                  ORGANIZATION IS SEQUENTIAL
000053                  FILE STATUS  IS TRANREPT-STATUS.
```

The `ASSIGN TO TRANREPT` maps to a JCL DD statement that controls the output destination and security class. In the migrated system, the output destination is an Azure Blob Storage container with RBAC policies.

**Note:** The mainframe RACF profiles and JES output routing are not represented in the COBOL source code — they are configured at the infrastructure level. The migrated system must implement equivalent controls in Azure AD and Azure Blob Storage access policies.

## Acceptance Criteria

### Scenario 1: AML report restricted to compliance and MLRO

```gherkin
GIVEN an AML screening report has been generated
  AND user "maria.eriksson" has role "Operations Manager"
WHEN the user attempts to access the AML report
THEN access is denied
  AND an access-denied event is logged in the audit trail
  AND the user is informed they lack authorization for restricted reports
```

### Scenario 2: Customer accesses own statement via online banking

```gherkin
GIVEN customer "Anders Lindqvist" is authenticated via Azure AD B2C
  AND the customer has account "12345678901"
WHEN the customer requests their January 2026 statement
THEN the statement for account "12345678901" is returned
  AND the statement includes PII masking per RPT-BR-003 (card number masked)
  AND the access is logged with customer ID and timestamp
  AND the customer cannot access any other customer's statements
```

### Scenario 3: Compliance officer distributes FSA report

```gherkin
GIVEN user "erik.johansson" has role "Compliance Officer"
  AND the Q4 2025 FSA capital adequacy report is ready for submission
WHEN the compliance officer initiates distribution
THEN the report is available in the secure portal for compliance review
  AND the report can be submitted to FSA via the regulatory submission workflow (RPT-BR-011)
  AND the distribution event is logged in the audit trail
```

### Scenario 4: Management report distributed via encrypted email

```gherkin
GIVEN the daily operations summary report has been generated
  AND the report is classified as "Internal"
WHEN the scheduled distribution runs
THEN the report is emailed to authorized management recipients
  AND the email attachment is a password-protected PDF
  AND the distribution is logged with recipient list and timestamp
```

### Scenario 5: Unauthorized access attempt logged

```gherkin
GIVEN user "anna.berg" has role "Customer Service"
  AND the user attempts to access the portfolio delinquency report
WHEN the access control check runs
THEN access is denied (Customer Service cannot access delinquency data)
  AND the denied access attempt is logged in the security audit trail
  AND if repeated denied attempts exceed threshold (5 in 1 hour), a security alert is raised
```

### Scenario 6: PSD2 AISP statement data access

```gherkin
GIVEN an authorized Account Information Service Provider (AISP) requests statement data
  AND the customer has granted consent for the AISP to access their account
WHEN the AISP requests transaction data via the PSD2 API
THEN only the customer's transaction list and balances are returned
  AND sensitive fields (internal risk ratings, AML flags) are excluded
  AND the API access is logged with AISP ID, customer consent reference, and timestamp
  AND the request is authenticated via OAuth 2.0 with SCA
```

## Regulatory Mapping

| Regulation | Article/Section | Requirement | How This Rule Satisfies It |
|---|---|---|---|
| FSA FFFS 2014:5 | Ch. 7 | Adequate systems for information security and access control | Role-based access control with report classification and audit logging |
| FSA FFFS 2014:5 | Ch. 8 §4 | Access to systems and data restricted based on role | Access control matrix ensures report access matches operational need |
| GDPR | Art. 5(1)(f) | Integrity and confidentiality of personal data | Encrypted distribution channels and access controls protect customer PII in reports |
| GDPR | Art. 25 | Data protection by design and by default | PII masking in statements, data minimization in API responses, role-based access |
| GDPR | Art. 32 | Security of processing including access control | Access logging, encrypted distribution, and authentication requirements |
| DORA | Art. 11 | ICT security policies including access management | Access control framework with classification, RBAC, and audit trail |

## Edge Cases

1. **Role overlap**: A user may have multiple roles (e.g., a compliance officer who is also the MLRO). The access control system must grant the union of permissions for all assigned roles, not require the user to switch roles.

2. **Temporary access elevation**: During a regulatory audit, an FSA inspector may need access to reports that would normally be restricted. The system must support temporary, time-limited access grants with explicit authorization, logging, and automatic revocation.

3. **Bulk statement export**: A GDPR Art. 15 data access request may require exporting all historical statements for a customer. This bulk export must be restricted to compliance officers and logged. Customer service agents should only access individual statements one at a time.

4. **Report data in transit**: When reports are distributed via email or API, the data must be encrypted in transit (TLS 1.2+) and at rest (Azure Storage Service Encryption). Plaintext report data must never traverse unencrypted channels.

5. **Separation of duties**: The person who generates a regulatory report should not be the same person who submits it to the FSA. The system should enforce a maker-checker workflow: one role generates, another role reviews and approves for submission.

6. **Deprovisioned user access**: When an employee leaves NordKredit, their access to all reports must be immediately revoked. The system must integrate with Azure AD lifecycle management for automatic deprovisioning. Any reports downloaded by the departing user should be flagged for review.

## Domain Expert Notes

- **null** (null): Awaiting domain expert review. CRITICAL QUESTIONS: (1) What RACF profiles are currently defined for report access on the mainframe? (2) How many distinct roles access reports today (beyond the A/U user type)? (3) Is there an existing maker-checker process for regulatory report submissions? (4) How are customer statements currently distributed — mail only, or is there online banking access? (5) Does NordKredit currently support PSD2 AISP access to statement data? (6) What is the current process for granting FSA inspectors access to report data during audits?

---

**Template version:** 1.0
**Last updated:** 2026-02-17
