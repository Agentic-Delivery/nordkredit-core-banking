---
id: DS-BMS-TRN02
title: "Transaction Add Screen"
copybook_name: "COTRN02.CPY"
domain: "ui-screens"
used_by_programs: [COTRN02C]
record_length: 0
status: "extracted"
target_schema: "N/A (screen layout)"
sidebar_position: 22
---

# DS-BMS-TRN02: Transaction Add Screen (COTRN02)

## Overview

The `COTRN02.CPY` copybook defines the **Transaction Add Screen**, a CICS BMS screen for manually entering new transactions. This screen provides input fields for all transaction details including account and card identification, transaction classification, amount, description, dates, and merchant information.

The copybook defines two symbolic map records:
- **CTRN02AI** -- Input record (receives all transaction field data from the terminal)
- **CTRN02AO** -- Output record (sends pre-populated data and messages to the terminal)

**Source file:** `COTRN02.CPY`
**BMS map name:** COTRN02
**Used by:** `COTRN02C` (Transaction Add CICS program)

## Key Screen Fields

| Field Name | Type | Length | Description |
|------------|------|--------|-------------|
| `TRNNAME` | Display | 4 | Transaction name (CICS transaction ID) |
| `PGMNAME` | Display | 8 | Program name display |
| `TITLE01` | Display | 40 | Screen title text |
| `CURDATE` | Display | 8 | Current date display |
| `CURTIME` | Display | 8 | Current time display |
| `ACTITEFN` | Input | 11 | Account ID |
| `CARDTEFN` | Input | 16 | Card number |
| `TTYTEFN` | Input | 2 | Transaction type code |
| `TCATEFN` | Input | 4 | Transaction category code |
| `TRSTEFN` | Input | 2 | Transaction source |
| `TRDSTEFN` | Input | 100 | Transaction description |
| `TRAMTEFN` | Input | 15 | Transaction amount |
| `TRPTEFN` | Input | 10 | Transaction processing date |
| `TORTEFN` | Input | 10 | Transaction origination date |
| `MCHTEFN` | Input | 50 | Merchant name |
| `MCTEFN` | Input | 20 | Merchant city |
| `MZTEFN` | Input | 10 | Merchant ZIP/postal code |
| `CONFIRM` | Input | 1 | Confirmation flag (`Y`/`N`) |
| `INFOMSG` | Display | 40 | Informational message area |
| `ERRMSG` | Display | 40 | Error message area |

## Screen Layout Notes

1. **Data entry form:** This screen is the input counterpart to the Transaction View Screen (COTRN01). All transaction fields are editable, allowing a user to manually create a new transaction record.

2. **Account and card entry:** The user enters both the account ID and card number. The program validates that the card belongs to the specified account and that both are active.

3. **Type and category codes:** The user must enter valid transaction type and category codes. These are validated against the transaction type (CVTRA03Y) and category (CVTRA04Y) reference files. The 3270 screen requires the user to know the codes; the .NET replacement should provide selection lists.

4. **Amount entry:** The amount field accepts numeric input. The program handles sign and decimal placement. The user may enter a negative amount for credits/reversals.

5. **Confirmation:** The `CONFIRM` field requires `Y` to submit the transaction. This two-step process prevents accidental transaction creation.

6. **Transaction ID generation:** The transaction ID is system-generated by the program; it is not entered by the user. The program assigns the next available ID upon successful submission.

7. **Dual dates:** Both processing date and origination date are entered. Processing date typically defaults to the current date; origination date may be backdated for late-arriving transactions.

## Target Architecture Mapping

| Aspect | CICS/3270 (Current) | .NET (Target) |
|--------|---------------------|---------------|
| **Screen** | BMS map `COTRN02` on 3270 terminal | Blazor/Razor page: `TransactionCreate.razor` / `TransactionCreate.cshtml` |
| **Program** | `COTRN02C` (COBOL CICS program) | `TransactionController.Create` action or Blazor form component |
| **Input validation** | COTRN02C program logic | Data annotations + FluentValidation on `CreateTransactionRequest` DTO |
| **Code entry** | Free-text type/category codes | Dropdown/select lists populated from reference data |
| **Amount entry** | Free-text numeric | Numeric input with currency formatting |
| **Date entry** | Text fields (`YYYY-MM-DD`) | Date picker components |
| **Confirmation** | `Y`/`N` text field | Review step with submit button |
| **ID generation** | Program-generated sequence | Database sequence or GUID generation |

### Migration Considerations

- **Authorization controls:** Manual transaction entry is a high-risk operation. The .NET implementation must enforce strict role-based access (e.g., only `TransactionOperator` role) and require dual authorization (maker-checker pattern) for transactions above a configurable threshold, per FSA (FFFS 2014:5) Ch. 8 internal controls.
- **Reference data lookups:** Replace free-text code entry with dropdown lists populated from the transaction type and category reference tables. This eliminates code memorization and reduces input errors.
- **PCI-DSS card number handling:** The card number input must be handled securely. Consider using a card search/lookup rather than direct card number entry to minimize PCI scope. If direct entry is required, the input must be encrypted in transit and not logged in plaintext.
- **AML monitoring:** Manual transaction creation must trigger real-time AML screening. Transactions matching suspicious patterns should be flagged automatically.
- **Audit trail:** Every field of the created transaction must be captured in the audit log, along with the creating user, timestamp, and authorization chain (if maker-checker is implemented).
- **Idempotency:** The .NET endpoint must prevent duplicate transaction creation from form resubmission using idempotency tokens.

---

**Template version:** 1.0
**Last updated:** 2026-02-15
