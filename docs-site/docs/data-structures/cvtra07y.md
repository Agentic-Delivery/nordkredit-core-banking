---
id: DS-TRPT-001
title: "Transaction Report Structures"
copybook_name: "CVTRA07Y.cpy"
domain: "transactions"
used_by_programs: [CORPT00C, CBTRN04C]
record_length: 0
status: "extracted"
target_schema: "N/A (report layout)"
sidebar_position: 12
---

# DS-TRPT-001: Transaction Report Structures (CVTRA07Y)

## Overview

The `CVTRA07Y.cpy` copybook defines **Transaction Report Structures**, a collection of record layouts used for formatting printed transaction reports. Unlike the other CVTRA copybooks, these are not database records -- they define the line-by-line output format for transaction reports generated by batch report programs.

The copybook contains multiple 01-level records, each representing a different section of the report output: headers, detail lines, and summary/total lines. This is a standard COBOL report formatting pattern where each record type corresponds to a print line layout.

**Source file:** `CVTRA07Y.cpy`
**Record length:** N/A (multiple record layouts, not a single fixed-length database record)
**Used by:** `CORPT00C`, `CBTRN04C`
**Output:** Printed reports / spool files

## Source COBOL

### Report Name Header

```cobol
01  REPORT-NAME-HEADER.
    05  REPORT-SHORT-NAME                       PIC X(20).
    05  FILLER                                  PIC X(10).
    05  REPORT-LONG-NAME                        PIC X(60).
    05  FILLER                                  PIC X(10).
    05  REPORT-DATE-RANGE                       PIC X(30).
    05  FILLER                                  PIC X(02).
```

### Transaction Detail Report Line

```cobol
01  TRANSACTION-DETAIL-REPORT.
    05  TRANSACTION-DETAIL-LINE.
       10  FILLER                               PIC X(02).
       10  REPORT-TRANS-ID                      PIC X(16).
       10  FILLER                               PIC X(02).
       10  REPORT-ACCT-ID                       PIC X(11).
       10  FILLER                               PIC X(02).
       10  REPORT-TYPE-CD                       PIC X(02).
       10  FILLER                               PIC X(02).
       10  REPORT-CAT-CD                        PIC X(04).
       10  FILLER                               PIC X(02).
       10  REPORT-SOURCE                        PIC X(10).
       10  FILLER                               PIC X(02).
       10  REPORT-TRAN-AMT                      PIC -ZZZ,ZZZ,ZZZ.ZZ.
       10  FILLER                               PIC X(02).
```

### Column Headers

```cobol
01  TRANSACTION-HEADER-1.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(16)
        VALUE 'TRANSACTION ID  '.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(11)
        VALUE 'ACCOUNT ID '.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(02)
        VALUE 'TY'.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(04)
        VALUE 'CAT '.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(10)
        VALUE 'SOURCE    '.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(15)
        VALUE '         AMOUNT'.
    05  FILLER                                  PIC X(02).

01  TRANSACTION-HEADER-2.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(16)
        VALUE '----------------'.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(11)
        VALUE '-----------'.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(02)
        VALUE '--'.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(04)
        VALUE '----'.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(10)
        VALUE '----------'.
    05  FILLER                                  PIC X(02).
    05  FILLER                                  PIC X(15)
        VALUE '---------------'.
    05  FILLER                                  PIC X(02).
```

### Summary/Total Lines

```cobol
01  REPORT-PAGE-TOTALS.
    05  FILLER                                  PIC X(40).
    05  FILLER                                  PIC X(15)
        VALUE '    PAGE TOTAL:'.
    05  FILLER                                  PIC X(02).
    05  REPORT-PAGE-TOTAL-AMT                   PIC -ZZZ,ZZZ,ZZZ.ZZ.
    05  FILLER                                  PIC X(02).

01  REPORT-ACCOUNT-TOTALS.
    05  FILLER                                  PIC X(40).
    05  FILLER                                  PIC X(15)
        VALUE ' ACCOUNT TOTAL:'.
    05  FILLER                                  PIC X(02).
    05  REPORT-ACCOUNT-TOTAL-AMT                PIC -ZZZ,ZZZ,ZZZ.ZZ.
    05  FILLER                                  PIC X(02).

01  REPORT-GRAND-TOTALS.
    05  FILLER                                  PIC X(40).
    05  FILLER                                  PIC X(15)
        VALUE '   GRAND TOTAL:'.
    05  FILLER                                  PIC X(02).
    05  REPORT-GRAND-TOTAL-AMT                  PIC -ZZZ,ZZZ,ZZZ.ZZ.
    05  FILLER                                  PIC X(02).
```

## Field Definitions

### REPORT-NAME-HEADER

| # | Field Name | PIC Clause | Type | Offset | Length | Description |
|---|------------|-----------|------|--------|--------|-------------|
| 1 | `REPORT-SHORT-NAME` | `X(20)` | Alphanumeric | 0 | 20 | Report short/abbreviated name |
| 2 | `FILLER` | `X(10)` | Filler | 20 | 10 | Spacing |
| 3 | `REPORT-LONG-NAME` | `X(60)` | Alphanumeric | 30 | 60 | Report full name/title |
| 4 | `FILLER` | `X(10)` | Filler | 90 | 10 | Spacing |
| 5 | `REPORT-DATE-RANGE` | `X(30)` | Alphanumeric | 100 | 30 | Date range for the report |
| 6 | `FILLER` | `X(02)` | Filler | 130 | 2 | Spacing |

### TRANSACTION-DETAIL-REPORT

| # | Field Name | PIC Clause | Type | Offset | Length | Description |
|---|------------|-----------|------|--------|--------|-------------|
| 1 | `FILLER` | `X(02)` | Filler | 0 | 2 | Left margin |
| 2 | `REPORT-TRANS-ID` | `X(16)` | Alphanumeric | 2 | 16 | Transaction identifier |
| 3 | `FILLER` | `X(02)` | Filler | 18 | 2 | Column spacing |
| 4 | `REPORT-ACCT-ID` | `X(11)` | Alphanumeric | 20 | 11 | Account identifier |
| 5 | `FILLER` | `X(02)` | Filler | 31 | 2 | Column spacing |
| 6 | `REPORT-TYPE-CD` | `X(02)` | Alphanumeric | 33 | 2 | Transaction type code |
| 7 | `FILLER` | `X(02)` | Filler | 35 | 2 | Column spacing |
| 8 | `REPORT-CAT-CD` | `X(04)` | Alphanumeric | 37 | 4 | Transaction category code |
| 9 | `FILLER` | `X(02)` | Filler | 41 | 2 | Column spacing |
| 10 | `REPORT-SOURCE` | `X(10)` | Alphanumeric | 43 | 10 | Transaction source |
| 11 | `FILLER` | `X(02)` | Filler | 53 | 2 | Column spacing |
| 12 | `REPORT-TRAN-AMT` | `-ZZZ,ZZZ,ZZZ.ZZ` | Edited numeric | 55 | 15 | Transaction amount (formatted) |
| 13 | `FILLER` | `X(02)` | Filler | 70 | 2 | Right margin |

### Summary Total Fields

| Record | Field Name | PIC Clause | Length | Description |
|--------|-----------|-----------|--------|-------------|
| `REPORT-PAGE-TOTALS` | `REPORT-PAGE-TOTAL-AMT` | `-ZZZ,ZZZ,ZZZ.ZZ` | 15 | Subtotal for the current page |
| `REPORT-ACCOUNT-TOTALS` | `REPORT-ACCOUNT-TOTAL-AMT` | `-ZZZ,ZZZ,ZZZ.ZZ` | 15 | Subtotal for the current account |
| `REPORT-GRAND-TOTALS` | `REPORT-GRAND-TOTAL-AMT` | `-ZZZ,ZZZ,ZZZ.ZZ` | 15 | Grand total for the entire report |

## Field Notes

1. **Edited PIC fields (`-ZZZ,ZZZ,ZZZ.ZZ`)** -- These are COBOL "edited numeric" fields used exclusively for display/print formatting. The `-` prefix means a leading minus sign appears only for negative values. `Z` represents zero-suppression (leading zeros are replaced with spaces). Commas and decimal point are inserted at the indicated positions. Example output: `  1,234,567.89` or `-    5,432.10`. These fields are **not** used for arithmetic -- they are the output-formatted versions of underlying numeric fields.

2. **FILLER fields** -- The numerous FILLER fields provide column spacing for the fixed-width report layout. They create the visual separation between data columns on the printed report. This is the standard COBOL approach to formatting tabular reports.

3. **REPORT-NAME-HEADER** -- Printed at the top of each report. Contains the report's short name, full name/title, and the date range covered by the report.

4. **TRANSACTION-HEADER-1 / HEADER-2** -- Column header and separator lines printed at the top of each page. `HEADER-1` contains the column labels; `HEADER-2` contains the dashed separator lines underneath.

5. **Summary totals** -- Three levels of totals: page-level (printed at the bottom of each page), account-level (printed after all transactions for an account), and grand total (printed at the end of the report). This hierarchical totaling pattern is standard for financial reports.

## EBCDIC Encoding Notes

| Field | EBCDIC Consideration |
|-------|---------------------|
| All `PIC X` fields | Standard EBCDIC-to-UTF-8 conversion. These are display fields containing report text. |
| Edited numeric fields | Already formatted as display strings in EBCDIC. Convert character-by-character to UTF-8. The minus sign, commas, decimal point, and space characters all require EBCDIC-to-ASCII mapping. |
| VALUE literals | COBOL VALUE clauses contain EBCDIC string literals. These are compile-time constants and do not need runtime conversion -- they define the report column headers. |

## Referential Integrity

Not applicable. These are report formatting structures, not database records. The data fields reference values from:

- `REPORT-TRANS-ID` -- sourced from `CVTRA05Y.TRAN-ID` or `CVTRA06Y.DALYTRAN-ID`
- `REPORT-ACCT-ID` -- sourced from account lookup during report generation
- `REPORT-TYPE-CD` -- sourced from `CVTRA05Y.TRAN-TYPE-CD` or `CVTRA06Y.DALYTRAN-TYPE-CD`
- `REPORT-CAT-CD` -- sourced from `CVTRA05Y.TRAN-CAT-CD` or `CVTRA06Y.DALYTRAN-CAT-CD`
- `REPORT-SOURCE` -- sourced from `CVTRA05Y.TRAN-SOURCE` or `CVTRA06Y.DALYTRAN-SOURCE`
- `REPORT-TRAN-AMT` -- formatted version of `CVTRA05Y.TRAN-AMT` or `CVTRA06Y.DALYTRAN-AMT`

## Sample Data

### Report Output Example

```
TRAN-RPT-01       TRANSACTION DETAIL REPORT                                   2026-01-01 TO 2026-01-31

  TRANSACTION ID    ACCOUNT ID  TY  CAT   SOURCE           AMOUNT
  ----------------  ----------- --  ----  ----------  ---------------
  0000000000000001  00000000123 SA  5001  POS           1,234,567.89
  0000000000000002  00000000123 CR  6001  ONLINE           -5,432.10
  0000000000000003  00000000123 SA  5002  ONLINE              125.50

                                              PAGE TOTAL:  1,229,261.29

                                           ACCOUNT TOTAL:  1,229,261.29

  0000000000000004  00000000456 SA  5001  POS              78,900.00
  0000000000000005  00000000456 PA  7001  BATCH           -25,000.00

                                           ACCOUNT TOTAL:     53,900.00

                                            GRAND TOTAL:  1,283,161.29
```

## Migration Notes

### Target Architecture

These report structures do **not** map to database tables. In the .NET target architecture, they map to report generation services and templates:

| COBOL Construct | .NET Target | Notes |
|----------------|-------------|-------|
| Report formatting copybook | Report template / DTO | Use a report DTO or view model in C# |
| `CORPT00C` report program | Report generation service | Azure Function (timer-triggered) or API endpoint |
| Printed spool output | PDF / Excel / HTML report | Use a reporting library (e.g., QuestPDF, ClosedXML, RDLC) |
| Edited PIC formatting | C# format strings | `string.Format("{0:N2}", amount)` or `amount.ToString("#,##0.00")` |
| Page/account/grand totals | LINQ aggregation | `Sum()`, `GroupBy()` for hierarchical totals |

### Report DTO Example (C#)

```csharp
public record TransactionReportHeader(
    string ShortName,
    string LongName,
    string DateRange
);

public record TransactionDetailLine(
    string TransactionId,
    string AccountId,
    string TypeCode,
    string CategoryCode,
    string Source,
    decimal Amount
);

public record TransactionReportTotals(
    decimal PageTotal,
    decimal AccountTotal,
    decimal GrandTotal
);
```

### Edited PIC Conversion

| COBOL Edited PIC | C# Format String | Example Output |
|-----------------|------------------|----------------|
| `-ZZZ,ZZZ,ZZZ.ZZ` | `"{0,15:N2}"` with conditional `-` | `  1,234,567.89` |
| `-ZZZ,ZZZ,ZZZ.ZZ` (negative) | `"{0,15:N2}"` | `-    5,432.10` |

> **Note:** The exact spacing and alignment must be validated during parallel-run to ensure the .NET-generated reports match the mainframe output character-for-character for reconciliation purposes.

### Post-Migration Validation

Report output comparison during parallel run:

1. Generate the same report from both mainframe and .NET system for the same date range
2. Compare line-by-line (ignoring trailing whitespace differences)
3. Verify all amounts match exactly (to the penny)
4. Verify page/account/grand totals match
5. Verify report header information matches

## Compliance Considerations

| Regulation | Requirement | Implementation |
|-----------|------------|----------------|
| **FSA (FFFS 2014:5)** | Ch. 4: Regulatory reports must be accurate and timely. Ch. 8: Internal controls over financial reporting. | Reports generated by the .NET system must produce identical financial totals to the mainframe reports. Implement automated reconciliation during parallel run. Report generation failures must trigger alerts. |
| **FSA (FFFS 2014:5)** | Regulatory reporting calendar compliance. | Monthly and periodic reports must meet FSA submission deadlines. Azure Function timer triggers must be configured to match mainframe batch schedules. |
| **PCI-DSS** | Cardholder data must not appear in reports unless necessary and authorized. | The `REPORT-TRANS-ID` field is safe, but if card numbers are added to future report variants, they must be masked. Review report distribution for PCI scope -- reports containing transaction detail are within PCI scope if they can be linked to cardholders. |
| **GDPR** | Reports containing personal data (account-level transaction data) are subject to data protection. | Report access must be role-controlled. Report output files (PDF, spool) must be stored securely with appropriate retention and deletion policies. Do not distribute reports containing personal data via unencrypted channels. |
| **AML/KYC** | Transaction reports support AML investigation and suspicious activity reporting. | Ensure AML analysts can generate transaction reports filtered by risk criteria. Report generation must support ad-hoc date ranges and account selections for investigations. |

---

**Template version:** 1.0
**Last updated:** 2026-02-15
